<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="animbook">
<title>animbook • animbook</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="animbook">
<meta property="og:description" content="animbook">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">animbook</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/animbook.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KrisanatA/animbook/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>animbook</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KrisanatA/animbook/blob/HEAD/vignettes/animbook.Rmd" class="external-link"><code>vignettes/animbook.Rmd</code></a></small>
      <div class="d-none name"><code>animbook.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KrisanatA/animbook" class="external-link">animbook</a></span><span class="op">)</span></span></code></pre></div>
<p>The inspiration for this package comes from the NY Times animated
plot. The challenge of reproducing the animation is the amount of code
required. This package tries to solve that by reducing it to only three
steps. This package also adds a new element of proportional Sankey
shaded area.</p>
<div class="section level3">
<h3 id="first-stage-prepare-the-data">First stage: Prepare the data<a class="anchor" aria-label="anchor" href="#first-stage-prepare-the-data"></a>
</h3>
<p>In this stage, we first need to prepare the data structure to a
specific format. This function will assign a frame, calculate the
scaling, and create the necessary data and settings for the next
stage.</p>
<p>The data needs to contain the following variable for the function to
work:</p>
<ul>
<li>id: <code>ID</code>, it needs to be a factor variable.</li>
<li>values: <code>sales</code>, needs to be a numeric variable.</li>
<li>time: <code>year</code>, it needs to be an integer variable.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animbook</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_prep.html">anim_prep</a></span><span class="op">(</span><span class="va">osiris</span>, <span class="va">ID</span>, <span class="va">sales</span>, <span class="va">year</span><span class="op">)</span></span>
<span><span class="co">#&gt; You can now pass the object to the plot function.</span></span></code></pre></div>
<p>There are also additional options that allow the user to
customize.</p>
<ul>
<li>label: group labeling.</li>
<li>ngroup: number of groups we want to split the values into.</li>
<li>breaks: the group bins size (prototype)</li>
<li>group_scaling: the grouping variable for the bins calculations.</li>
<li>color: the variable used to color the observations.</li>
<li>time_dependent: logical. Whether we want the observations to start
at the same time or not.</li>
<li>scaling: the scaling method, either <code>rank</code> or
<code>absolute</code>.</li>
<li>runif_min: minimum value for random addition to frame numbers</li>
<li>runif_max: maximum value for random addition to frame numbers</li>
</ul>
<p>The function can calculate four different scales using these
options.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rank scaling</span></span>
<span><span class="va">rank_scaling</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_prep.html">anim_prep</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">osiris</span>, id <span class="op">=</span> <span class="va">ID</span>, values <span class="op">=</span> <span class="va">sales</span>, time <span class="op">=</span> <span class="va">year</span><span class="op">)</span></span>
<span><span class="co">#&gt; You can now pass the object to the plot function.</span></span>
<span></span>
<span><span class="co"># absolute scaling</span></span>
<span><span class="va">absolute_scaling</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_prep.html">anim_prep</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">osiris</span>, id <span class="op">=</span> <span class="va">ID</span>, values <span class="op">=</span> <span class="va">sales</span>, time <span class="op">=</span> <span class="va">year</span>,</span>
<span>                              scaling <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span></span>
<span><span class="co">#&gt; You can now pass the object to the plot function.</span></span>
<span></span>
<span><span class="co"># rank scaling by group</span></span>
<span><span class="va">rank_group_scaling</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_prep.html">anim_prep</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">osiris</span>, id <span class="op">=</span> <span class="va">ID</span>, values <span class="op">=</span> <span class="va">sales</span>, time <span class="op">=</span> <span class="va">year</span>, </span>
<span>                                group <span class="op">=</span> <span class="va">country</span><span class="op">)</span></span>
<span><span class="co">#&gt; You can now pass the object to the plot function.</span></span>
<span></span>
<span><span class="co"># absolute scaling by group</span></span>
<span><span class="va">absolute_group_scaling</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_prep.html">anim_prep</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">osiris</span>, id <span class="op">=</span> <span class="va">ID</span>, values <span class="op">=</span> <span class="va">sales</span>, time <span class="op">=</span> <span class="va">year</span>,</span>
<span>                                    group <span class="op">=</span> <span class="va">country</span>, scaling <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span></span>
<span><span class="co">#&gt; You can now pass the object to the plot function.</span></span>
<span></span>
<span><span class="va">rank_scaling</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10,270 × 3</span></span></span>
<span><span class="co">#&gt;    id            time qtile</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AE30008GU     <span style="text-decoration: underline;">2</span>006     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AT9110050653  <span style="text-decoration: underline;">2</span>006     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> AU001150849   <span style="text-decoration: underline;">2</span>006     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> AU004085330   <span style="text-decoration: underline;">2</span>006     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> AU006624228   <span style="text-decoration: underline;">2</span>006     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AU008720223   <span style="text-decoration: underline;">2</span>006     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> AU009066648   <span style="text-decoration: underline;">2</span>006     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> AU009134114   <span style="text-decoration: underline;">2</span>006     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> AU009213754   <span style="text-decoration: underline;">2</span>006     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> AU009219809   <span style="text-decoration: underline;">2</span>006     2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10,260 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $settings</span></span>
<span><span class="co">#&gt; $settings$gap</span></span>
<span><span class="co">#&gt; [1] 1.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $settings$xbreaks</span></span>
<span><span class="co">#&gt;  [1] 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $settings$label</span></span>
<span><span class="co">#&gt; [1] "5" "4" "3" "2" "1" "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $settings$breaks_scales</span></span>
<span><span class="co">#&gt; [1] 0.0 0.2 0.4 0.6 0.8 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $settings$time_dependent</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "categorized"</span></span></code></pre></div>
<p>This function will return an <code>animbook</code> object containing
a list of the formatted data and settings.</p>
</div>
<div class="section level3">
<h3 id="second-stage-plotting-the-data">Second stage: Plotting the data<a class="anchor" aria-label="anchor" href="#second-stage-plotting-the-data"></a>
</h3>
<p>After preparing the data, we can not plot it. There are three plots
available in this package:</p>
<ul>
<li>
<code>kangaroo</code>, which plots the observation’s movement over
time.</li>
<li>
<code>wallaby</code>, which subset the plot to either
<code>top</code> or <code>bottom</code> and see which group they are in
after the observational period.</li>
<li>
<code>funnel_web_spider</code>, which is a faceted plot by time
variable.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Top 20%"</span>, <span class="st">"20-40"</span>, <span class="st">"40-60"</span>, <span class="st">"60-80"</span>, <span class="st">"80-100"</span>, <span class="st">"not listed"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">animbook</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_prep.html">anim_prep</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">osiris</span>, id <span class="op">=</span> <span class="va">ID</span>, values <span class="op">=</span> <span class="va">sales</span>, time <span class="op">=</span> <span class="va">year</span>, color <span class="op">=</span> <span class="va">japan</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span></span>
<span><span class="co">#&gt; You can now pass the object to the plot function.</span></span>
<span></span>
<span><span class="co"># kangaroo plot</span></span>
<span><span class="fu"><a href="../reference/kangaroo_plot.html">kangaroo_plot</a></span><span class="op">(</span><span class="va">animbook</span><span class="op">)</span></span>
<span><span class="co">#&gt; You can now used the animbook::anim_animate() function to transforemd it</span></span>
<span><span class="co">#&gt;           to an animated object.</span></span></code></pre></div>
<p><img src="animbook_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># wallaby plot</span></span>
<span><span class="fu"><a href="../reference/wallaby_plot.html">wallaby_plot</a></span><span class="op">(</span><span class="va">animbook</span><span class="op">)</span></span>
<span><span class="co">#&gt; You can now used the animbook::anim_animate() function to transformed it</span></span>
<span><span class="co">#&gt;           to an animated object.</span></span></code></pre></div>
<p><img src="animbook_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>            </span>
<span><span class="co"># funnel web spider plot</span></span>
<span><span class="fu"><a href="../reference/funnel_web_plot.html">funnel_web_plot</a></span><span class="op">(</span><span class="va">animbook</span><span class="op">)</span></span></code></pre></div>
<p><img src="animbook_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
<p>The <code>kangaroo</code> and <code>wallaby</code> plots can be
animated using the function of the next stage.
<code>funnel_web_spider</code> only supported static plot. We can also
choose whether we want to animate the plot using gganimate or
plotly.</p>
</div>
<div class="section level3">
<h3 id="third-stage-animating-the-plot">Third stage: Animating the plot<a class="anchor" aria-label="anchor" href="#third-stage-animating-the-plot"></a>
</h3>
<p>To animate the plot, we need to save the plot into an object, which
then can be passed on to the function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animbook</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_prep_cat.html">anim_prep_cat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aeles</span>, id <span class="op">=</span> <span class="va">id</span>, values <span class="op">=</span> <span class="va">party</span>, time <span class="op">=</span> <span class="va">year</span>, color <span class="op">=</span> <span class="va">gender</span>, time_dependent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallaby_plot.html">wallaby_plot</a></span><span class="op">(</span><span class="va">animbook</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_animate.html">anim_animate</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gganimate</span><span class="fu">::</span><span class="fu"><a href="https://gganimate.com/reference/animate.html" class="external-link">animate</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/example.gif"><!-- --></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Krisanat Anukarnsakulchularp.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
